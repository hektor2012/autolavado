<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>AUTOLAVADO FAD</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!-- ============================== -->
  <!-- MODAL LOGIN                   -->
  <!-- ============================== -->
  <div id="loginModal" class="modal" style="display:flex;">
    <div class="modal-contenido">
      <h2>Iniciar Sesión</h2>
      <label>Usuario:</label>
      <input type="text" id="loginUsuario" placeholder="Nombre de usuario">
      <label>Clave:</label>
      <input type="password" id="loginClave" placeholder="Contraseña">
      <button onclick="iniciarSesion()">Entrar</button>
    </div>
  </div>

  <!-- ============================== -->
  <!-- BARRA SUPERIOR                 -->
  <!-- ============================== -->
  <div class="user-box">
    <span id="usuarioActual"></span>
    <button onclick="mostrarLoginModal()">👤</button>
  </div>

  <div class="header">
    <div class="header-left">👥 </div>
    <div class="header-center">AUTOLAVADO "<span>FAD</span>"</div>
    <div class="header-right">
      <button class="btn-header" id="btnajustes">⚙️ AJUSTES</button>
      <button class="btn-header" onclick="cerrarSesion()">⬆️ SALIR</button>
    </div>
  </div>

  <!-- ============================== -->
  <!-- BOTONES PRINCIPALES           -->
  <!-- ============================== -->
  <div class="main-buttons">
    <button id="btnLavado">Ventas</button>
    <button id="btnReporte">Reporte Lavados</button>
    <button id="btnNotificaciones">🔔 Notificaciones</button>
  </div>

  <div class="paquetes-container" id="contenedor-paquetes"></div>

  <div class="footer-logo">
    <img src="img/logo.jpg" alt="Logo Estética Automotriz">
  </div>

  <!-- ============================== -->
  <!-- MODAL SERVICIO                -->
  <!-- ============================== -->
  <div class="modal" id="modal-servicio">
    <div class="modal-content">
      <h3 id="modal-paquete-nombre"></h3>
      <p id="modal-paquete-precio"></p>
      <input type="text" id="input-marca" placeholder="Marca del vehículo">
      <input type="text" id="input-modelo" placeholder="Modelo del vehículo">
      <input type="tel" id="input-whatsapp" placeholder="WhatsApp (opcional)">
      <label><input type="checkbox" id="input-notificar"> Enviar mensaje cuando esté listo</label>
      <div class="modal-buttons">
        <button id="btn-modal-aceptar">Aceptar</button>
        <button id="btn-modal-cancelar">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- ============================== -->
  <!-- MODAL AJUSTES                 -->
  <!-- ============================== -->
  <div class="modal" id="modal-ajustes">
    <div class="modal-content ajustes">
      <div class="tabs">
        <button class="tab-btn active" onclick="cambiarTab('generales')">Generales</button>
        <button class="tab-btn" onclick="cambiarTab('paquetes')">Paquetes</button>
        <button class="tab-btn" id="btnUsuariosTab" onclick="cambiarTab('usuarios')">Usuarios</button>
      </div>

      <!-- TAB GENERALES -->
      <div class="tab-section" id="tab-generales">
        <h2>Configuración de Ticket</h2>
        <label>Nombre</label>
        <input type="text" id="aj-nombre">
        <label>Dirección</label>
        <input type="text" id="aj-direccion">
        <label>Leyenda 1</label>
        <input type="text" id="aj-leyenda1">
        <label>Leyenda Principal</label>
        <textarea id="aj-leyenda" rows="5"></textarea>
        <label>Leyenda de Despedida</label>
        <input type="text" id="aj-ticket">
        <label for="aj-whatsapp">WhatsApp del establecimiento:</label>
        <input type="text" id="aj-whatsapp" placeholder="Ej. 7221234567">
        <label>Logo del autolavado:</label>
        <input type="file" id="aj-logo" accept="image/*">
        <img id="vista-logo" src="" alt="Logo" style="max-height: 80px; margin-top: 10px;">
        <div class="modal-buttons">
          <button id="btn-guardar-ajustes">Guardar</button>
          <button onclick="cerrarModalAjustes()">Cancelar</button>
        </div>
        <button id="btnBorrarServicios" style="margin-top: 20px; background-color: darkred; color: white;">
          🗑 Borrar todos los registros
        </button>
      </div>

      <!-- TAB PAQUETES -->
      <div class="tab-section" id="tab-paquetes" style="display:none;">
        <h2>Paquetes de Servicio</h2>
        <div style="margin-top: 10px;">
          <label>Nombre del Paquete</label>
          <input type="text" id="nuevo-nombre">
          <label>Precio ($)</label>
          <input type="number" id="nuevo-precio">
          <button id="btn-agregar-paquete" style="margin-top: 10px;">➕ Agregar</button>
        </div>
        <h3 style="margin-top: 20px;">Lista de Paquetes</h3>
        <table style="width: 100%; margin-top: 10px; text-align: left;">
          <thead>
            <tr><th>Nombre</th><th>Precio</th><th>Acciones</th></tr>
          </thead>
          <tbody id="tabla-paquetes"></tbody>
        </table>
        <div class="modal-buttons">
          <button onclick="cerrarModalAjustes()">Cerrar</button>
        </div>
      </div>

      <!-- MODAL EDITAR PAQUETE -->
      <div id="modalEditarPaquete" class="modal" style="display:none;">
        <div class="modal-content">
          <h3>Editar Paquete</h3>
          <input type="hidden" id="editarId">
          <input type="text" id="editarNombre" placeholder="Nombre">
          <input type="number" id="editarPrecio" placeholder="Precio">
          <label>Color fondo:</label>
          <input type="color" id="editarColorFondo">
          <label>Color texto:</label>
          <input type="color" id="editarColorTexto">
          <br><br>
          <button onclick="guardarCambiosPaquete()">Guardar Cambios</button>
          <button onclick="cerrarModalEditar()">Cancelar</button>
        </div>
      </div>

      <!-- TAB USUARIOS -->
      <div class="tab-section" id="tab-usuarios" style="display: none;">
        <h3>👥 Gestión de Usuarios</h3>
        <h4>Crear nuevo usuario</h4>
        <input type="text" id="nuevoNombre" placeholder="Nombre de usuario">
        <input type="password" id="nuevaClave" placeholder="Contraseña">
        <select id="nuevoRol">
          <option value="cajero">Cajero</option>
          <option value="admin">Administrador</option>
        </select>
        <button onclick="crearUsuario()">Crear</button>
        <hr style="margin: 20px 0;">
        <h4>Cambiar contraseña de un usuario</h4>
        <select id="selectUsuario"></select>
        <input type="password" id="claveNueva" placeholder="Nueva contraseña">
        <button onclick="cambiarClave()">Cambiar clave</button>
        <button onclick="eliminarUsuario()" style="margin-top: 10px; background-color: crimson; color: white;">
          🗑️ Eliminar usuario
        </button>
      </div>
    </div>
  </div>

  <!-- ============================== -->
  <!-- MODAL REPORTES                -->
  <!-- ============================== -->
  <div class="modal" id="modal-reportes">
    <div class="modal-content reportes">
      <h2 style="text-align:center;">📋 Reporte de Lavados</h2>
      <div style="display:flex; justify-content:space-between; flex-wrap:wrap; gap:10px; margin: 10px 0;">
        <div>
          <label>Fecha Inicio:</label>
          <input type="date" id="filtro-inicio">
        </div>
        <div>
          <label>Fecha Fin:</label>
          <input type="date" id="filtro-fin">
        </div>
        <div style="align-self: end;">
          <button id="btn-buscar-reporte">Buscar</button>
          <button id="btn-corte">🧾 Corte de Caja</button>
          <button id="btn-exportar-excel">📤 Exportar Excel</button>
          <button onclick="cerrarModalReporte()">❌ Salir</button>
        </div>
      </div>
      <table style="width:100%; margin-top:10px; text-align:left;">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Hora</th>
            <th>Paquete</th>
            <th>Marca/Modelo</th>
            <th>Importe</th>
          </tr>
        </thead>
        <tbody id="tabla-reporte"></tbody>
      </table>
      <div style="margin-top: 15px; text-align: right;">
        <strong>Total del Día: $<span id="total-dia">0.00</span></strong><br>
        <strong>Total de Servicios: <span id="total-servicios">0</span></strong>
      </div>
      <div id="corte-caja" style="display: none; border-top: 1px solid #ccc; margin-top: 20px; padding-top: 10px;">
        <h3>🧾 Corte de Caja</h3>
        <div id="detalle-corte"></div>
        <div style="margin-top:10px;">
          <button onclick="window.print()">🖨 Imprimir</button>
          <button onclick="document.getElementById('corte-caja').style.display = 'none'">❌ Ocultar</button>
          <button onclick="cerrarTurno()">🔒 Cerrar Turno</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================== -->
  <!-- MODAL NOTIFICACIONES          -->
  <!-- ============================== -->
  <div id="modal-notificaciones" class="modal" style="display:none;">
    <div class="modal-content" style="width: 90%; max-width: 600px;">
      <h3>🚘 Vehículos pendientes de notificar</h3>
      <table style="width: 100%; border-collapse: collapse;" id="tabla-notificaciones">
        <thead>
          <tr>
            <th>Folio</th>
            <th>Marca</th>
            <th>Modelo</th>
            <th>WhatsApp</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <br>
      <button onclick="cerrarModalNotificaciones()">Cerrar</button>
    </div>
  </div>

  <!-- ============================== -->
  <!-- MODAL TURNO                   -->
  <!-- ============================== -->
  <div id="modal-turno" class="modal" style="display:none;">
    <div class="modal-content">
      <h2>Iniciar Turno</h2>
      <label>Operador:</label>
      <input type="text" id="turno-operador" placeholder="Nombre del operador">
      <label>Clave:</label>
      <input type="password" id="turno-clave" placeholder="Contraseña">
      <button onclick="iniciarTurno()">Iniciar turno</button>
    </div>
  </div>

  <script src="js/main.js" defer></script>
  <iframe id="ticket-frame" style="display:none;"></iframe>
</body>
</html>
